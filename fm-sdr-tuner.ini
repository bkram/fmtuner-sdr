# FM-SDR-Tuner configuration file
#
# Run with:
#   ./build/fm-sdr-tuner -c fm-sdr-tuner.ini -w test.wav
#
# Notes:
# - Source selection can be done entirely here via [tuner].source
# - CLI flags still override config values when provided

[tuner]
# Source mode:
#   rtl_sdr (direct USB RTL-SDR)
#   rtl_tcp (network rtl_tcp server)
source = rtl_sdr

# Device index for direct RTL-SDR mode
rtl_device = 0

# Initial frequency in kHz (e.g. 88600 = 88.6 MHz)
default_freq = 88600

# Deemphasis:
#   0 = 50us
#   1 = 75us
#   2 = off
deemphasis = 0

[rtl_tcp]
# Used when [tuner].source = rtl_tcp
host = localhost
port = 1234

[audio]
# Enable speaker output by default (equivalent to passing -s)
enable_audio = true
# Output device selector (index or partial name)
# Leave empty to use system default.
device = BlackHole 2ch

[sdr]
# Manual gain in dB:
#   -1 = auto strategy
#   >=0 = fixed gain
# (kept commented to match your previous setup)
#rtl_gain_db = -1

# Gain strategy:
#   tef   = TEF-like AGC profile behavior
#   sdrpp = SDR++ style behavior
gain_strategy = sdrpp

# Restored previous SDR++ gain settings
sdrpp_rtl_agc = true
sdrpp_rtl_agc_gain_db = 18

# XDR signal meter mapping (dBFS compensation window)
signal_floor_dbfs = -55.0
signal_ceil_dbfs = -19.0

# Custom gain flags, packed as decimal digits:
#   tens = RF flag (0/1)
#   ones = IF flag (0/1)
# Example: 11 => RF=1, IF=1
default_custom_gain_flags = 0

[xdr]
# XDR server listen port
port = 7373

# Optional password (empty = no password requirement)
password = test123

# Allow guest mode auth bypass
guest_mode = false

[processing]
# AGC mode profile (0..3)
agc_mode = 2

# Allow client-issued gain changes (XDR commands)
client_gain_allowed = true

# Fixed DSP processing block size (input IQ samples per cycle).
# Higher values reduce control-loop overhead; lower values can reduce latency.
dsp_block_samples = 8192

# W0 fallback bandwidth in Hz (used because automatic width switching is not implemented).
# Recommended SDR-like default: 194000 (about 192 kHz class).
# Set to 0 to keep widest behavior.
w0_bandwidth_hz = 194000

# Stereo blend behavior:
#   soft, normal, aggressive
stereo_blend = normal

# Enable stereo decode path
stereo = true

[debug]
# 0 = quiet, 1 = info, 2+ = more verbose
log_level = 1

[reconnection]
# Attempt reconnect after repeated IQ read failures
auto_reconnect = true
